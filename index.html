<html>

<head>
  <meta charset="utf-8">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js"></script>
  <link rel="stylesheet" type="text/css" href="css/style.css">
</head>

<body>
  <div id="main">
    <table id="stream" width="100%">
      <thead>
        <th>SiteID</th>
        <th>Site Name</th>
        <th>Region</th>
        <th>Reach</th>
        <th>Site Type</th>
      </thead>
      <tbody>

      </tbody>
    </table>
  </div>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>
  <script type='text/javascript'>
    var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/18NouPc0AcnQ4A2jWsTtcHqWU2vXd80cqZHpVTcBv4w8/edit?usp=sharing';

    function init() {
      Tabletop.init({
        key: publicSpreadsheetUrl,
        callback: showInfo,
        simpleSheet: true,
        order: 'SiteID'
      })
    }

    function showInfo(data, tabletop) {
      var stream = data;
      console.log(data);
      
      for (var i = 0; i < data.length; i++) {
        document.querySelector('table').innerHTML = data.map(({ SiteID, Site_Name, Region, Reach, Site_Type }) => {
          return `
          <tr>
            <td>${SiteID}</td>
            <td>${Site_Name}</td>
            <td>${Region}</td>
            <td>${Reach}</td>
            <td>${Site_Type}</td>
          </tr>
          `
        }).join('\n')
      }

      document.querySelector('table').appendChild(tr)
    }

    window.addEventListener('DOMContentLoaded', init)
  </script>
</body>

</html>